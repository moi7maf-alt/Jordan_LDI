
import React, { useState } from 'react';
import Card from './ui/Card';
import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, Cell, PieChart, Pie } from 'recharts';
import { GOVERNORATE_COLORS } from '../constants/colors';
import { 
    TOTAL_BENEFICIARIES_2024,
    EMERGENCY_AID_2024,
    TRAINING_PROGRAM_2024,
    EMPLOYMENT_PROGRAM_2024
} from '../constants/socialDevelopmentData';
import { Document, Packer, Paragraph, TextRun, AlignmentType, IStylesOptions } from 'docx';
import saveAs from 'file-saver';

const KpiCard: React.FC<{ title: string; value: string; icon: string; }> = ({ title, value, icon }) => (
    <div className="bg-gray-100 p-4 rounded-xl text-center shadow-sm h-full flex flex-col justify-center break-inside-avoid kpi-card-visual">
        <div className="text-3xl mb-2 icon-container">{icon}</div>
        <p className="text-2xl font-bold text-amber-600">{value}</p>
        <p className="text-xs text-gray-500 mt-1">{title}</p>
    </div>
);

const reportContent = [
    {
        title: "1. Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ ÙˆØ§Ù„Ø£Ø«Ø± Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ",
        content: `ÙŠØ´ÙƒÙ„ Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© ØµÙ…Ø§Ù… Ø§Ù„Ø£Ù…Ø§Ù† Ù„Ù„Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ÙŠ ÙÙŠ Ø§Ù„Ø£Ø±Ø¯Ù†. Ù…Ù† Ø®Ù„Ø§Ù„ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ø¹ÙˆÙ†Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© ÙˆÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªÙ†Ù…ÙŠØ©ØŒ ÙŠØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø´Ø¨ÙƒØ© Ø­Ù…Ø§ÙŠØ© Ù„Ù€ 239,177 Ø£Ø³Ø±Ø© ØªØ¶Ù… Ø£ÙƒØ«Ø± Ù…Ù† 1.1 Ù…Ù„ÙŠÙˆÙ† ÙØ±Ø¯. Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ Ù„Ù„Ù‚Ø·Ø§Ø¹ ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ø¥ØºØ§Ø«Ø© Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø¥Ù„Ù‰ Ù…Ø­Ø§ÙˆÙ„Ø© "ÙƒØ³Ø± Ø­Ù„Ù‚Ø© Ø§Ù„ÙÙ‚Ø± Ø§Ù„Ù…ØªÙˆØ§Ø±Ø«" Ù…Ù† Ø®Ù„Ø§Ù„ Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„ØªÙ…ÙƒÙŠÙ† Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠ ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø³ØªØ¶Ø¹ÙØ©. ÙˆÙ…Ø¹ Ø°Ù„ÙƒØŒ ÙŠØ¸Ù„ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„ÙƒØ¨ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹ÙˆÙ†Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ØªØ­Ø¯ÙŠØ§Ù‹ Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø¯ÙˆÙ„Ø©ØŒ Ù…Ù…Ø§ ÙŠØ³ØªØ¯Ø¹ÙŠ ØªØ³Ø±ÙŠØ¹ Ø§Ù„ØªØ­ÙˆÙ„ Ù†Ø­Ùˆ Ø¨Ø±Ø§Ù…Ø¬ "Ø§Ù„ØªØ®Ø±ÙŠØ¬" Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ´ØºÙŠÙ„ ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©.`
    },
    {
        title: "2. Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø¹Ø§Ù… Ù„Ù„Ù‚Ø·Ø§Ø¹ ÙˆØ§Ù„Ù…Ø´Ù‡Ø¯ Ø§Ù„Ø¯ÙŠÙ…ÙˆØºØ±Ø§ÙÙŠ",
        content: `ØªØ±ØªØ¨Ø· Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© Ø§Ø±ØªØ¨Ø§Ø·Ø§Ù‹ ÙˆØ«ÙŠÙ‚Ø§Ù‹ Ø¨Ø§Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„Ø¯ÙŠÙ…ÙˆØºØ±Ø§ÙÙŠØ© Ù„Ù„ÙÙ‚Ø±. ØªØ´ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø£Ù† 71% Ù…Ù† Ø§Ù„Ø£Ø³Ø± Ø§Ù„Ù…Ø³ØªÙÙŠØ¯Ø© Ù…Ù† Ø§Ù„Ù…Ø¹ÙˆÙ†Ø© ØªØ±Ø£Ø³Ù‡Ø§ Ù†Ø³Ø§Ø¡ØŒ Ù…Ù…Ø§ ÙŠØ¤ÙƒØ¯ Ø¸Ø§Ù‡Ø±Ø© "ØªØ£Ù†ÙŠØ« Ø§Ù„ÙÙ‚Ø±". Ø¬ØºØ±Ø§ÙÙŠØ§Ù‹ØŒ ØªØªØµØ¯Ø± Ø§Ù„Ø¹Ø§ØµÙ…Ø© ÙˆØ¥Ø±Ø¨Ø¯ Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ† Ø¨Ø­ÙƒÙ… Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø³ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø¹Ø§Ù„ÙŠØ©ØŒ Ù„ÙƒÙ† "Ù†Ø³Ø¨Ø© Ø§Ù„ÙÙ‚Ø±" (ÙƒØ«Ø§ÙØ© Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ† Ù†Ø³Ø¨Ø© Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙƒØ§Ù†) ØªÙƒÙˆÙ† Ø£Ø´Ø¯ ÙˆØ·Ø£Ø© ÙÙŠ Ù…Ø­Ø§ÙØ¸Ø§Øª Ø§Ù„Ø£Ø·Ø±Ø§Ù (Ø§Ù„Ø·ÙÙŠÙ„Ø©ØŒ Ù…Ø¹Ø§Ù†ØŒ Ø§Ù„Ù…ÙØ±Ù‚) Ø­ÙŠØ« ØªØªÙ‚Ù„Øµ ÙØ±Øµ Ø§Ù„Ø¹Ù…Ù„ ÙˆØªØ¶Ø¹Ù Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ©. Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø§Ø±Ø·Ø© Ø§Ù„Ø¯ÙŠÙ…ÙˆØºØ±Ø§ÙÙŠØ© ØªØªØ·Ù„Ø¨ Ø¨Ø±Ø§Ù…Ø¬ Ù…ÙˆØ¬Ù‡Ø© ØªØ£Ø®Ø° Ø¨Ø¹ÙŠÙ† Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± Ø®ØµÙˆØµÙŠØ© ÙƒÙ„ Ù…Ù†Ø·Ù‚Ø©.`
    },
    {
        title: "3. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„ØªÙ†Ù…ÙˆÙŠ ÙˆØ§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (KPIs)",
        content: `ÙŠÙØ¸Ù‡Ø± Ø§Ù„Ù‚Ø·Ø§Ø¹ Ù†Ø¬Ø§Ø­Ø§Ù‹ Ù…Ù„Ù…ÙˆØ³Ø§Ù‹ ÙÙŠ Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©ØŒ Ø­ÙŠØ« Ø§Ø±ØªÙØ¹ Ø¹Ø¯Ø¯ Ø®Ø±ÙŠØ¬ÙŠ Ø¯ÙˆØ± Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ù…Ù†Ø¯Ù…Ø¬ÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ØŒ ÙˆØ²Ø§Ø¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø·ÙØ§Ù„ ÙÙŠ Ø§Ù„Ø£Ø³Ø± Ø§Ù„Ø±Ø§Ø¹ÙŠØ©ØŒ Ù…Ù…Ø§ ÙŠØ¹ÙƒØ³ ØªØ­ÙˆÙ„Ø§Ù‹ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Ù‹ Ù†Ø­Ùˆ "Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø±ÙŠØ©" Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠØ© Ø§Ù„ØªÙŠ Ø£Ø«Ø¨ØªØª Ø§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ù…Ø­Ø¯ÙˆØ¯ÙŠØ© Ø£Ø«Ø±Ù‡Ø§ Ø§Ù„Ù†ÙØ³ÙŠ ÙˆØ§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ. ÙÙŠ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„ØŒ Ø§Ù†Ø®ÙØ¶ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ† Ù…Ù† Ø§Ù„Ø­Ø¶Ø§Ù†Ø§ØªØŒ ÙˆÙ‡Ùˆ Ù…Ø¤Ø´Ø± Ø³Ù„Ø¨ÙŠ ÙŠØ¤Ø«Ø± Ø¨Ø´ÙƒÙ„ Ù…Ø¨Ø§Ø´Ø± Ø¹Ù„Ù‰ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ø±Ø£Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©. ÙƒÙ…Ø§ Ø­Ù‚Ù‚ Ù…Ù„Ù Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„ØªØ³ÙˆÙ„ ØªÙ‚Ø¯Ù…Ø§Ù‹ ÙÙŠ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¶Ø¨Ø·ØŒ Ù…Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø§Ù„Ù…ØªØ²Ø§ÙŠØ¯ Ø¹Ù„Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ£Ù‡ÙŠÙ„ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ù…Ø¬Ø±Ø¯ Ø§Ù„Ø§Ø­ØªØ¬Ø§Ø² ÙˆØ§Ù„Ø¹Ù‚Ø§Ø¨.`
    },
    {
        title: "4. Ø¯Ø±Ø§Ø³Ø© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØªÙ†Ù…ÙˆÙŠØ© ÙˆÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯",
        content: `ÙŠÙØ¯ÙŠØ± ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ø¹ÙˆÙ†Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù…ÙˆØ§Ø²Ù†Ø© Ø´Ù‡Ø±ÙŠØ© Ø¶Ø®Ù…Ø© ØªØªØ¬Ø§ÙˆØ² 20.7 Ù…Ù„ÙŠÙˆÙ† Ø¯ÙŠÙ†Ø§Ø±. ÙƒÙØ§Ø¡Ø© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ØªÙ‚Ø§Ø³ Ø¨Ù…Ø¯Ù‰ ÙˆØµÙˆÙ„Ù‡Ø§ Ù„Ù„Ù…Ø³ØªØ­Ù‚ÙŠÙ† Ø§Ù„ÙØ¹Ù„ÙŠÙŠÙ† (Targeting Efficiency). Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ÙˆØ·Ù†ÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯ ÙˆØªÙƒØ§Ù…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø³Ø§Ù‡Ù… ÙÙŠ ØªÙ‚Ù„ÙŠÙ„ Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ù…ÙˆÙ„ ÙˆØ§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø¨Ø´ÙƒÙ„ Ù…Ù„Ø­ÙˆØ¸. ÙˆÙ…Ø¹ Ø°Ù„ÙƒØŒ ÙØ¥Ù† Ø§Ù„ØªØ­Ø¯ÙŠ Ø§Ù„Ø£ÙƒØ¨Ø± ÙŠÙƒÙ…Ù† ÙÙŠ "ØªØ®Ø±ÙŠØ¬" Ø§Ù„Ø£Ø³Ø± Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…. Ù„Ø§ ØªØ²Ø§Ù„ Ù†Ø³Ø¨Ø© Ø§Ù„Ø£Ø³Ø± Ø§Ù„ØªÙŠ ØªØºØ§Ø¯Ø± Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø¨Ø³Ø¨Ø¨ ØªØ­Ø³Ù† ÙˆØ¶Ø¹Ù‡Ø§ Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠ Ù…Ù†Ø®ÙØ¶Ø© Ø¬Ø¯Ø§Ù‹ØŒ Ù…Ù…Ø§ ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ Ø£Ù† Ø§Ù„Ù…Ø¹ÙˆÙ†Ø© ØªØªØ­ÙˆÙ„ ÙÙŠ ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø£Ø­ÙŠØ§Ù† Ø¥Ù„Ù‰ Ø¯Ø®Ù„ Ø¯Ø§Ø¦Ù… Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø£Ù† ØªÙƒÙˆÙ† Ø¬Ø³Ø±Ø§Ù‹ Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ù„Ø¹Ø¨ÙˆØ± Ù†Ø­Ùˆ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø°Ø§Øª.`
    },
    {
        title: "5. ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙØ¬ÙˆØ§Øª ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø± ÙˆØ§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠØ©",
        content: `**ÙØ¬ÙˆØ© Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ:** ØªÙˆØ§Ø¬Ù‡ Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ Ø£Ø²Ù…Ø© ÙˆØ¬ÙˆØ¯ÙŠØ©ØŒ Ø­ÙŠØ« Ø§Ù†Ø®ÙØ¶ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ Ù„Ù„Ø¬Ù…Ø¹ÙŠØ§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø© Ù…Ø¹ Ø­Ù„ Ù…Ø¦Ø§Øª Ø§Ù„Ø¬Ù…Ø¹ÙŠØ§Øª Ø³Ù†ÙˆÙŠØ§Ù‹. Ù‡Ø°Ø§ Ø§Ù„ØªØ±Ø§Ø¬Ø¹ ÙŠØ¹ÙƒØ³ Ø¶Ø¹Ù Ø§Ù„Ø­ÙˆÙƒÙ…Ø©ØŒ Ù†Ù‚Øµ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ØŒ ÙˆØºÙŠØ§Ø¨ Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©ØŒ Ù…Ù…Ø§ ÙŠØ¶Ø¹Ù Ø¯ÙˆØ± "Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø«Ø§Ù„Ø«" ÙƒØ´Ø±ÙŠÙƒ Ù„Ù„Ø­ÙƒÙˆÙ…Ø©.\n**Ø§Ù„Ù…Ø®Ø§Ø·Ø±:** ØªØ´Ù…Ù„ ØªØ²Ø§ÙŠØ¯ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ù†Ù Ø§Ù„Ø£Ø³Ø±ÙŠ ÙˆØ§Ù„ØªÙÙƒÙƒ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ Ø§Ù„Ù†Ø§ØªØ¬Ø© Ø¹Ù† Ø§Ù„Ø¶ØºÙˆØ· Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ© Ø§Ù„Ù…ØªÙØ§Ù‚Ù…Ø©ØŒ Ù…Ù…Ø§ ÙŠØ²ÙŠØ¯ Ø§Ù„Ø¹Ø¨Ø¡ Ø¹Ù„Ù‰ Ø¯ÙˆØ± Ø§Ù„Ø­Ù…Ø§ÙŠØ© ÙˆØ§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„ØªÙŠ ØªØ¹Ù…Ù„ Ø£ØµÙ„Ø§Ù‹ Ø¨Ø·Ø§Ù‚ØªÙ‡Ø§ Ø§Ù„Ù‚ØµÙˆÙ‰.`
    },
    {
        title: "6. Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª ÙˆØ§Ù„ØªÙˆØ¬Ù‡Ø§Øª Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ù„Ù„Ù‚Ø·Ø§Ø¹",
        content: `ØªØªØ±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª ÙÙŠ:\n1. **Ø§Ù„ØªÙ…ÙƒÙŠÙ† Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø±Ø¹Ø§ÙŠØ©:** ØªØ­ÙˆÙŠÙ„ Ø´Ø¹Ø§Ø± "Ù…Ù† Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ§Ø¬" Ø¥Ù„Ù‰ ÙˆØ§Ù‚Ø¹ Ù…Ù„Ù…ÙˆØ³ Ù…Ù† Ø®Ù„Ø§Ù„ Ø±Ø¨Ø· Ø§Ù„Ù…Ø¹ÙˆÙ†Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø¨Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…Ù‡Ù†ÙŠ ÙˆØ§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠ Ù„Ù„Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ù‚Ø§Ø¯Ø±ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ ÙÙŠ Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„Ù…Ø³ØªÙÙŠØ¯Ø©.\n2. **Ø§Ù„Ù„Ø§Ù…Ø±ÙƒØ²ÙŠØ© ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª:** ØªÙÙˆÙŠØ¶ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø£ÙˆØ³Ø¹ Ù„Ù…Ø¯ÙŠØ±ÙŠØ§Øª Ø§Ù„ØªÙ†Ù…ÙŠØ© ÙÙŠ Ø§Ù„Ù…ÙŠØ¯Ø§Ù† Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø­Ø§Ù„Ø§Øª ÙˆØµØ±Ù Ø§Ù„Ù…Ø¹ÙˆÙ†Ø§Øª Ø§Ù„Ø·Ø§Ø±Ø¦Ø© Ù„Ø¶Ù…Ø§Ù† Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØ©.\n3. **Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø·ÙÙˆÙ„Ø© Ø§Ù„Ù…Ø¨ÙƒØ±Ø©:** Ø¯Ø¹Ù… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø¶Ø§Ù†Ø§Øª Ù…Ù†Ø²Ù„ÙŠØ© ÙˆÙ…Ø¤Ø³Ø³ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø£Ù‚Ù„ Ø­Ø¸Ø§Ù‹ Ù„ØªÙ…ÙƒÙŠÙ† Ø§Ù„Ø£Ù…Ù‡Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ù„Ø§Øª ÙˆØªÙˆÙÙŠØ± Ø¨ÙŠØ¦Ø© Ø¢Ù…Ù†Ø© ÙˆÙ…Ø­ÙØ²Ø© Ù„Ù„Ø£Ø·ÙØ§Ù„.`
    },
    {
        title: "7. Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„ØªØ®Ø·ÙŠØ·ÙŠØ© ÙˆÙ…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ†ÙÙŠØ°",
        content: `Ù„ØªØ¹Ø²ÙŠØ² Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ ÙˆØªØ·ÙˆÙŠØ±Ù‡Ø§ØŒ ÙŠÙˆØµÙ‰ Ø¨ØªØ¨Ù†ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ§Ù„ÙŠØ©:
* **ØµÙ†Ø§Ø¯ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Ù Ø§Ù„ØªÙ†Ù…ÙˆÙŠ:** Ø¥Ø·Ù„Ø§Ù‚ ØªØ´Ø±ÙŠØ¹Ø§Øª Ù„ØªØ´Ø¬ÙŠØ¹ Ø¥Ù†Ø´Ø§Ø¡ ØµÙ†Ø§Ø¯ÙŠÙ‚ ÙˆÙ‚ÙÙŠØ© Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ø®Ø§ØµØ© ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§ØªØŒ ØªÙˆØ¬Ù‡ Ø¹ÙˆØ§Ø¦Ø¯Ù‡Ø§ Ù„Ø¯Ø¹Ù… Ù…Ø´Ø§Ø±ÙŠØ¹ Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ù„Ù„Ø£Ø³Ø± Ø§Ù„ÙÙ‚ÙŠØ±Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø§ÙƒØªÙØ§Ø¡ Ø¨Ø§Ù„Ù…Ø¹ÙˆÙ†Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ù…Ù‚Ø·ÙˆØ¹Ø©.
* **ØªÙ…Ù‡ÙŠÙ† Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ:** Ù…Ø£Ø³Ø³Ø© Ù…Ù‡Ù†Ø© "Ø§Ù„Ø£Ø®ØµØ§Ø¦ÙŠ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ" ÙˆØ¥ØµØ¯Ø§Ø± Ø±Ø®Øµ Ù…Ø²Ø§ÙˆÙ„Ø© Ù…Ù‡Ù†Ø©ØŒ Ù„Ø±ÙØ¹ ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ† ÙÙŠ Ø¯ÙˆØ± Ø§Ù„Ø±Ø¹Ø§ÙŠØ© ÙˆÙ…ÙƒØ§ØªØ¨ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø© Ø¨Ø§Ø­ØªØ±Ø§ÙÙŠØ©.
* **Ø§Ù„Ø¹Ø¯Ø§Ù„Ø© Ø§Ù„ØªØµØ§Ù„Ø­ÙŠØ© Ù„Ù„Ø£Ø­Ø¯Ø§Ø«:** Ø§Ù„ØªÙˆØ³Ø¹ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø¯Ø§Ø¦Ù„ Ø§Ù„Ø§Ø­ØªØ¬Ø§Ø² ÙˆØªØ¯Ø§Ø¨ÙŠØ± Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ÙŠØ© Ù„Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¬Ø§Ù†Ø­ÙŠÙ† (ØºÙŠØ± Ø§Ù„Ø®Ø·Ø±ÙŠÙ†) Ù„Ø¶Ù…Ø§Ù† Ø¥Ø¹Ø§Ø¯Ø© Ø¯Ù…Ø¬Ù‡Ù… ÙÙŠ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ ÙˆØªØ¬Ù†ÙŠØ¨Ù‡Ù… Ø§Ù„ÙˆØµÙ…Ø© Ø§Ù„Ø¬Ø±Ù…ÙŠØ©.
* **Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ·Ø© (CCT):** Ø§Ù„ØªØ­ÙˆÙ„ ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹ Ù†Ø­Ùˆ Ø±Ø¨Ø· Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ù…Ø¹ÙˆÙ†Ø© Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø¨Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ø£Ø³Ø±Ø© Ø¨Ø´Ø±ÙˆØ· ØªÙ†Ù…ÙˆÙŠØ© ØµØ§Ø±Ù…Ø© (Ù…Ø«Ù„ Ø¹Ø¯Ù… ØªØ³Ø±Ø¨ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ù…Ù† Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ØŒ ÙˆØ¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ÙØ­ÙˆØµØ§Øª Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ø¯ÙˆØ±ÙŠØ© ÙˆØ§Ù„Ù…Ø·Ø§Ø¹ÙŠÙ…)ØŒ Ù„Ø¶Ù…Ø§Ù† Ø£Ù† Ø§Ù„Ù…Ø¹ÙˆÙ†Ø© ØªØ³Ø§Ù‡Ù… ÙÙŠ Ø¨Ù†Ø§Ø¡ Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ø§Ù„Ø¨Ø´Ø±ÙŠ Ù„Ù„Ø£Ø¨Ù†Ø§Ø¡ ÙˆØªÙƒØ³Ø± Ø­Ù„Ù‚Ø© Ø§Ù„ÙÙ‚Ø± Ø§Ù„Ù…ØªÙˆØ§Ø±Ø«.
* **Ø¯Ø¹Ù… Ø°ÙˆÙŠ Ø§Ù„Ø¥Ø¹Ø§Ù‚Ø©:** ØªØ®ØµÙŠØµ Ø¬Ø²Ø¡ Ù…Ù† Ù…ÙˆØ§Ø²Ù†Ø§Øª Ø§Ù„Ù„Ø§Ù…Ø±ÙƒØ²ÙŠØ© Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© (Ù…Ù…Ø±Ø§ØªØŒ Ù…ØµØ§Ø¹Ø¯) ÙÙŠ Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„Ù…Ø¯Ø§Ø±Ø³ Ù„Ø¯Ù…Ø¬ Ø°ÙˆÙŠ Ø§Ù„Ø¥Ø¹Ø§Ù‚Ø©ØŒ ÙˆØªÙØ¹ÙŠÙ„ ÙƒÙˆØ¯Ø§Øª Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡Ù… Ø¨ØµØ±Ø§Ù…Ø©.
* **Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø¬Ù…Ø¹ÙŠØ§Øª Ø§Ù„Ø®ÙŠØ±ÙŠØ©:** Ø¥Ø·Ù„Ø§Ù‚ Ù…Ù†ØµØ© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù„ØªÙ‚ÙŠÙŠÙ… Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¬Ù…Ø¹ÙŠØ§Øª Ø§Ù„Ø®ÙŠØ±ÙŠØ© Ø¨Ø´ÙØ§ÙÙŠØ©ØŒ ÙˆØ±Ø¨Ø· Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠ Ø¨Ù…Ø¯Ù‰ ØªØ­Ù‚ÙŠÙ‚ Ø£Ø«Ø± ØªÙ†Ù…ÙˆÙŠ Ù…Ù„Ù…ÙˆØ³ ÙˆÙ„ÙŠØ³ Ø¨Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ø´ÙƒÙ„ÙŠØ©.`
    }
];

const SocialDevelopment: React.FC = () => {
    const [isExportingDocx, setIsExportingDocx] = useState(false);

    const handleExportDocx = async () => {
        setIsExportingDocx(true);
        try {
            const title = "Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù‚Ø·Ø§Ø¹ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„: Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© 2024";
            
            const docStyles: IStylesOptions = {
                default: { document: { run: { font: "Arial", size: 24, rightToLeft: true } } },
                paragraphStyles: [
                    { id: "Normal", name: "Normal", run: { size: 24 }, paragraph: { spacing: { after: 120 }, alignment: AlignmentType.RIGHT } },
                    { id: "h1", name: "h1", run: { size: 32, bold: true, color: "2E74B5" }, paragraph: { alignment: AlignmentType.CENTER, spacing: { before: 240, after: 120 } } },
                    { id: "h2", name: "h2", run: { size: 28, bold: true, color: "4F81BD" }, paragraph: { spacing: { before: 240, after: 120 }, alignment: AlignmentType.RIGHT } },
                ],
            };

            const children = [
                new Paragraph({ text: title, style: "h1" }),
                ...reportContent.flatMap(section => [
                    new Paragraph({ text: section.title, style: "h2" }),
                    new Paragraph({ text: section.content, style: "Normal" })
                ])
            ];

            const doc = new Document({
                styles: docStyles,
                sections: [{ properties: { page: { margin: { top: 1440, right: 1440, bottom: 1440, left: 1440 } } }, children }],
            });

            const blob = await Packer.toBlob(doc);
            saveAs(blob, `${title}.docx`);
        } catch (error) {
            console.error("Failed to export DOCX:", error);
        } finally {
            setIsExportingDocx(false);
        }
    };

    const handleNativePrint = () => {
        const reportElement = document.getElementById('report-content');
        if (!reportElement) return;

        const printWindow = window.open('', '', 'height=800,width=1000');
        if (!printWindow) return;

        const headContent = `
            <head>
                <title>ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© - 2024</title>
                <style>
                    @import url('https://fonts.googleapis.com/css2?family=Traditional+Arabic:wght@400;700&display=swap');
                    body {
                        font-family: 'Traditional Arabic', serif;
                        direction: rtl;
                        padding: 40px;
                        background: white !important;
                        color: black !important;
                        font-size: 14pt;
                        line-height: 1.6;
                    }
                    .no-print, .recharts-wrapper, button, svg, .icon-container, .kpi-card-visual { display: none !important; }
                    .card-container { box-shadow: none !important; border: none !important; padding: 0 !important; margin-bottom: 20px !important; }
                    h1 { font-size: 24pt; font-weight: bold; text-align: center; border-bottom: 3px solid #000; margin-bottom: 30px; padding-bottom: 10px; }
                    h2 { font-size: 18pt; font-weight: bold; border-bottom: 1px solid #666; margin-top: 30px; margin-bottom: 15px; }
                    p, li { text-align: justify; margin-bottom: 12px; }
                    @page { size: A4; margin: 2.5cm; }
                </style>
            </head>
        `;

        const htmlContent = `
            <html>
                ${headContent}
                <body>
                    <div class="report-header">
                        <h1>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù‚Ø·Ø§Ø¹ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„: Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© 2024</h1>
                    </div>
                    <div class="content">
                        ${reportContent.map(section => `
                            <h2>${section.title}</h2>
                            <p>${section.content.replace(/\n/g, '<br/>')}</p>
                        `).join('')}
                    </div>
                     <div class="report-footer" style="text-align: center; margin-top: 50px; font-size: 12pt; color: #666; border-top: 1px solid #ccc; padding-top: 10px;">
                        ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© - Ù…Ø¯ÙŠØ±ÙŠØ© Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ© | Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ù‚Ù…ÙŠ
                    </div>
                </body>
            </html>
        `;

        printWindow.document.open();
        printWindow.document.write(htmlContent);
        printWindow.document.close();

        setTimeout(() => {
            printWindow.focus();
            printWindow.print();
            printWindow.close();
        }, 1000);
    };


    return (
        <div className="space-y-8">
             <div className="flex justify-end items-center mb-6 no-print gap-4">
                <button 
                    onClick={handleExportDocx} 
                    disabled={isExportingDocx}
                    className="px-4 py-2 text-sm font-medium text-black bg-amber-500 rounded-lg hover:bg-amber-600 focus:ring-4 focus:outline-none focus:ring-amber-300 disabled:bg-gray-400 flex items-center gap-2"
                >
                    ØªØµØ¯ÙŠØ± (DOCX)
                </button>
                <button onClick={handleNativePrint} className="px-4 py-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-amber-600 flex items-center gap-2">
                    Ø·Ø¨Ø§Ø¹Ø© (ØªÙ‚Ø±ÙŠØ± Ù†ØµÙŠ)
                </button>
            </div>
            
            <div id="report-content" className="space-y-8">
                <header className="text-center border-b border-gray-200 dark:border-gray-700 pb-8 no-print">
                    <h1 className="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ: Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</h1>
                    <p className="text-lg text-gray-500 dark:text-gray-400 mt-2 max-w-3xl mx-auto">
                        Ù†Ø¸Ø±Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØŒ Ø§Ù„ÙÙ‚Ø±ØŒ ÙˆØ§Ù„ØªÙ…ÙƒÙŠÙ† (2024).
                    </p>
                </header>

                {reportContent.map((section, idx) => (
                    <Card key={idx} className="card-container">
                        <h2 className="text-2xl font-bold text-gray-900 dark:text-white mb-4">{section.title}</h2>
                        <div className="text-gray-700 dark:text-gray-300 leading-relaxed text-lg whitespace-pre-line">
                            {section.content.split('\n').map((line, i) => {
                                const parts = line.split(/(\*\*.*?\*\*)/g);
                                return (
                                    <p key={i} className="mb-3">
                                        {parts.map((part, j) => 
                                            part.startsWith('**') && part.endsWith('**') 
                                                ? <strong key={j} className="font-bold text-gray-900 dark:text-white">{part.slice(2, -2)}</strong> 
                                                : part
                                        )}
                                    </p>
                                );
                            })}
                        </div>
                        {idx === 2 && (
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8 kpi-card-visual">
                                <KpiCard title="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø³Ø± Ø§Ù„Ù…Ø³ØªÙÙŠØ¯Ø©" value="239,177" icon="ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" />
                                <KpiCard title="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ†" value="1,117,253" icon="ğŸ‘¥" />
                                <KpiCard title="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¹ÙˆÙ†Ø© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©" value="20.7 Ù…Ù„ÙŠÙˆÙ† Ø¯.Ø£" icon="ğŸ’°" />
                                <KpiCard title="Ù†Ø³Ø¨Ø© Ø§Ù„Ø£Ø³Ø± Ø§Ù„ØªÙŠ ØªØ±Ø£Ø³Ù‡Ø§ Ù†Ø³Ø§Ø¡" value="71%" icon="ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" />
                            </div>
                        )}
                    </Card>
                ))}
            </div>
        </div>
    );
};

export default SocialDevelopment;
